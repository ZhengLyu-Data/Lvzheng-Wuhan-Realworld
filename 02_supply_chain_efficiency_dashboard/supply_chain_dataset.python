# ğŸ“¦ STEP 1: Upload Files
from google.colab import files
uploaded = files.upload()

# âœ… STEP 2: Read the original CSV data
import pandas as pd

df = pd.read_csv("supply_chain_raw.csv")

# Check the first few lines
print("ğŸ” Original data previewï¼š")
print(df.head())

# âœ… STEP 3: Field standardizationï¼ˆThe column name is lowercase, and the space is replacedï¼‰
df.columns = [col.strip().lower().replace(" ", "_") for col in df.columns]

# âœ… STEP 4: Field name change unified style
df = df.rename(columns={
    'reached.on_time_y.n': 'on_time_delivery',
    'cost_of_the_product': 'product_cost',
    'discount_offered': 'discount',
    'weight_in_gms': 'weight_grams'
})

# âœ… STEP 5: Check the missing value
print("\nğŸ§¹ missing value statisticsï¼š")
print(df.isnull().sum())

# âœ… STEP 6: Data type checkï¼ˆConvert before visualizationï¼‰
print("\nğŸ“ field typeï¼š")
print(df.dtypes)

# âœ… STEP 7: Export the cleaned csv file
output_path = "supply_chain_cleaned.csv"
df.to_csv(output_path, index=False)

# ğŸ“¥ STEP 8: Provide downloads
files.download(output_path)
